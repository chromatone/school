import{a0 as j,o as B,f as o,h as r,p as N,q as S,k as E,G as V,H as q,I as z,u as c,j as t,t as a,C as G,a1 as L}from"./framework.BrhOyqmp.js";import{u as O}from"./useWS.DBbuWdMW.js";import{u as $}from"./useHash.mPwdT7Su.js";import{f as C}from"./format.BLmWzEp7.js";import"./theme.C31g09kU.js";const D={class:"flex gap-4 py-8 overflow-x-scroll max-w-100vw min-h-40"},F={class:"i-la-spinner text-4xl animate-spin absolute",key:"spinner"},I=["href"],T={class:"flex w-full font-mono p-2"},W={class:"text-sm"},A={class:"text-sm"},J={class:"flex items-start gap-2"},K={class:"op-60"},P={class:"px-2 py-1 bg-light-800 rounded-lg text-xs"},Q={class:"flex-1 text-lg p-2 bg-light-700"},R={class:"flex flex-wrap gap-2 items-center p-2"},U=["src"],X={class:"p-0"},es={__name:"EventsList",setup(Y){const{ws:H}=O(),i=j([]),M=$();return B(async()=>{const{subscription:n}=await H.subscribe("events",{uid:"events-list-sub",query:{sort:["date"],fields:["*","module.title","course.level","course.teacher.*","course.program.title","course.program.color"]}});for await(const e of n)switch(e.event){case"init":Object.assign(i,e.data);break;case"update":e.data.forEach(s=>Object.assign(i.find(l=>l.id==s.id),s));break}}),(n,e)=>(o(),r("div",D,[N(L,{name:"fade"},{default:S(()=>[i.length==0?(o(),r("div",F)):E("",!0),(o(!0),r(V,null,q(i,s=>{var l,d,u,m,h,p,f,_,x,g,b,w,y,k;return o(),r("a",{class:z(["no-underline shadow-lg flex flex-col rounded-xl transition",{[c(M)==s.id?"bg-orange-200":"bg-light-200"]:!0}]),key:s.id,href:`#${s.id}`,style:{flex:"1 0 220px"}},[t("div",T,[t("div",W,a(c(C)(s.date," HH:mm EEE")),1),e[0]||(e[0]=t("div",{class:"flex-1"},null,-1)),t("div",A,a(c(C)(s.date,"dd MMM yy")),1)]),t("div",{class:"flex flex-col p-2",style:G({backgroundColor:(d=(l=s==null?void 0:s.course)==null?void 0:l.program)==null?void 0:d.color})},[t("div",J,[t("div",K,a((m=(u=s==null?void 0:s.course)==null?void 0:u.program)==null?void 0:m.title),1),t("div",P,a((h=s==null?void 0:s.course)==null?void 0:h.level),1)])],4),t("div",Q,a((p=s==null?void 0:s.module)==null?void 0:p.title),1),t("div",R,[(_=(f=s==null?void 0:s.course)==null?void 0:f.teacher)!=null&&_.avatar?(o(),r("img",{key:0,class:"rounded-full w-30px h-30px",src:`https://schooldb.chromatone.center/assets/${(g=(x=s==null?void 0:s.course)==null?void 0:x.teacher)==null?void 0:g.avatar}?width=30&height=30`},null,8,U)):E("",!0),t("div",X,a((w=(b=s==null?void 0:s.course)==null?void 0:b.teacher)==null?void 0:w.first_name)+" "+a((k=(y=s==null?void 0:s.course)==null?void 0:y.teacher)==null?void 0:k.last_name),1)])],10,I)}),128))]),_:1})]))}};export{es as default};
