import{u as B,l as E,F,K as x,U as M}from"./theme.BMQUz6G8.js";import{r as m,o as U,N as q,O as C,P as D,I as H,p as L,a as _,c as v,b as p,t as d,u as l,F as N,m as P,g as j}from"./framework.BZaulDZr.js";import{f as A}from"./format.CHl3EdWp.js";function G(){const i=m(window.location.hash.slice(1)),t=()=>{i.value=window.location.hash.slice(1)},e=s=>{window.location.hash=s};return U(()=>{window.addEventListener("hashchange",t)}),q(()=>{window.removeEventListener("hashchange",t)}),{hash:i,setHash:e}}typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const K=()=>{};function b(i,t,e){let s;C(e)?s={evaluating:e}:s={};const{lazy:c=!1,evaluating:a=void 0,shallow:f=!0,onError:w=K}=s,y=m(!c),r=f?D(t):m(t);let o=0;return H(async h=>{if(!y.value)return;o++;const u=o;let n=!1;a&&Promise.resolve().then(()=>{a.value=!0});try{const g=await i(k=>{h(()=>{a&&(a.value=!1),n||k()})});u===o&&(r.value=g)}catch(g){w(g)}finally{a&&u===o&&(a.value=!1),n=!0}}),c?L(()=>(y.value=!0,r.value)):r}const S={class:"flex flex-col gap-4"},V={class:"text-xl"},W={class:"text-2xl font-bold"},z={class:"text-lg"},I={class:"flex flex-wrap gap-2 p-2"},$={__name:"ClassPage",setup(i){const{hash:t}=G(),e=b(async()=>await E("https://schooldb.chromatone.center/").with(F()).request(x("classes",t.value,{fields:["*","course.*"]})),[]),{user:s,userDB:c}=B(),a=b(async()=>s.value&&await c.request(x("classes",t.value,{fields:["students.*","students.directus_users_id.*"]})),[]),f=m(!1);async function w(){await c.request(M("classes_directus_users",{classes_id:e.value.id,directus_users_id:s.value.id})),f.value=!0}return(y,r)=>{var o,h,u;return _(),v("div",S,[p("a",V,d((h=(o=l(e))==null?void 0:o.course)==null?void 0:h.title),1),p("div",W,d(l(e).title),1),p("div",z,d(l(A)(l(e).date||Date.now(),"dd-MMM-yyyy")),1),p("div",I,[(_(!0),v(N,null,P((u=l(a))==null?void 0:u.students,n=>(_(),v("div",{class:"p-2 bg-dark-800 rounded-xl",key:n},d(n.directus_users_id.first_name)+" "+d(n.directus_users_id.last_name),1))),128))]),l(s)&&!f.value?(_(),v("button",{key:0,class:"p-2 border-2",onClick:r[0]||(r[0]=n=>w())},"Join")):j("",!0)])}}};export{$ as default};
