import{l as B,F as L,c as W,G as z}from"./theme.BlrQnV7_.js";import{u as q}from"./useHash.BjdL9CFZ.js";import{t as y,c as H,n as R,s as O,m as $,a as Z,b as A,g as G,f as p}from"./format.DrP95sbi.js";import{r as V,c as j,u as i,e as f,f as m,h as u,t as d,F as N,C as b,D as T,j as w,E as J}from"./framework.LhDnjOZs.js";function K(r,e,t){const n=y(r,t==null?void 0:t.in);return isNaN(e)?H(r,NaN):(e&&n.setDate(n.getDate()+e),n)}function P(r,e){const t=y(r,e==null?void 0:e.in).getDay();return t===0||t===6}function D(r,e,t){const[n,l]=R(t==null?void 0:t.in,r,e);return+O(n)==+O(l)}function v(r,e){return y(r,e==null?void 0:e.in).getDate()===1}function Q(r,e,t){const[n,l]=R(t==null?void 0:t.in,r,e);return n.getFullYear()===l.getFullYear()&&n.getMonth()===l.getMonth()}function x(r,e){const t=()=>H(e==null?void 0:e.in,NaN),n=(e==null?void 0:e.additionalDigits)??2,l=re(r);let c;if(l.date){const a=ne(l.date,n);c=se(a.restDateString,a.year)}if(!c||isNaN(+c))return t();const g=+c;let h=0,o;if(l.time&&(h=ae(l.time),isNaN(h)))return t();if(l.timezone){if(o=ie(l.timezone),isNaN(o))return t()}else{const a=new Date(g+h),s=y(0,e==null?void 0:e.in);return s.setFullYear(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()),s.setHours(a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()),s}return y(g+h+o,e==null?void 0:e.in)}const k={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},X=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,ee=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,te=/^([+-])(\d{2})(?::?(\d{2}))?$/;function re(r){const e={},t=r.split(k.dateTimeDelimiter);let n;if(t.length>2)return e;if(/:/.test(t[0])?n=t[0]:(e.date=t[0],n=t[1],k.timeZoneDelimiter.test(e.date)&&(e.date=r.split(k.timeZoneDelimiter)[0],n=r.substr(e.date.length,r.length))),n){const l=k.timezone.exec(n);l?(e.time=n.replace(l[1],""),e.timezone=l[1]):e.time=n}return e}function ne(r,e){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),n=r.match(t);if(!n)return{year:NaN,restDateString:""};const l=n[1]?parseInt(n[1]):null,c=n[2]?parseInt(n[2]):null;return{year:c===null?l:c*100,restDateString:r.slice((n[1]||n[2]).length)}}function se(r,e){if(e===null)return new Date(NaN);const t=r.match(X);if(!t)return new Date(NaN);const n=!!t[4],l=_(t[1]),c=_(t[2])-1,g=_(t[3]),h=_(t[4]),o=_(t[5])-1;if(n)return de(e,h,o)?le(e,h,o):new Date(NaN);{const a=new Date(0);return!oe(e,c,g)||!ce(e,l)?new Date(NaN):(a.setUTCFullYear(e,c,Math.max(l,g)),a)}}function _(r){return r?parseInt(r):1}function ae(r){const e=r.match(ee);if(!e)return NaN;const t=C(e[1]),n=C(e[2]),l=C(e[3]);return fe(t,n,l)?t*$+n*Z+l*1e3:NaN}function C(r){return r&&parseFloat(r.replace(",","."))||0}function ie(r){if(r==="Z")return 0;const e=r.match(te);if(!e)return 0;const t=e[1]==="+"?-1:1,n=parseInt(e[2]),l=e[3]&&parseInt(e[3])||0;return me(n,l)?t*(n*$+l*Z):NaN}function le(r,e,t){const n=new Date(0);n.setUTCFullYear(r,0,4);const l=n.getUTCDay()||7,c=(e-1)*7+t+1-l;return n.setUTCDate(n.getUTCDate()+c),n}const ue=[31,null,31,30,31,30,31,31,30,31,30,31];function E(r){return r%400===0||r%4===0&&r%100!==0}function oe(r,e,t){return e>=0&&e<=11&&t>=1&&t<=(ue[e]||(E(r)?29:28))}function ce(r,e){return e>=1&&e<=(E(r)?366:365)}function de(r,e,t){return e>=1&&e<=53&&t>=0&&t<=6}function fe(r,e,t){return r===24?e===0&&t===0:t>=0&&t<60&&e>=0&&e<60&&r>=0&&r<25}function me(r,e){return e>=0&&e<=59}const ge={key:0,class:"flex flex-col"},he={class:"text-lg mb-4 mx-2"},De={class:"grid gap-2 mb-8 not-prose overflow-x-scroll font-mono",style:{"grid-template-columns":"1fr 1fr 3fr 1fr 3fr 1fr 3fr"}},xe={class:"text-sm font-semibold"},pe={key:0,class:"flex flex-col gap-2"},_e=["href"],ye={class:"text-xs font-bold bg-light-100 bg-op-80 rounded p-1"},Ne={class:"text-10px uppercase px-1 rounded font-bold brightness-140 saturate-80"},be={class:"text-sm"},Te={class:"text-sm bg-orange-600 px-1 text-white rounded"},ke={key:1,class:"flex flex-col gap-2"},we=["href"],Ce={class:"text-xs font-bold bg-light-100 bg-op-80 rounded p-1"},Fe={class:"text-sm",style:{flex:"1 1 220px"}},Se=7,Me=5,ze={__name:"ClassSchedule",setup(r){const e=B("https://schooldb.chromatone.center/").with(L()),t=W(async()=>await e.request(z("classes",{fields:["*","module.title","course.level","course.program.slug","course.program.color"]})),[]),n=W(async()=>await e.request(z("events",{fields:["*"]})),[]),l=V(A(new Date,{weekStartsOn:0})),c=j(()=>Array.from({length:Se*Me},(h,o)=>K(l.value,o))),g=q();return(h,o)=>i(g)?w("",!0):(f(),m("div",ge,[o[2]||(o[2]=u("div",{class:"text-2xl mt-8 mx-2"},"Class Schedule",-1)),u("div",he,"Week "+d(i(G)(Date.now())),1),u("div",De,[(f(),m(N,null,b(["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],a=>u("div",{class:T(["rounded font-bold bg-gray-400 p-2",{"bg-orange-300":["Sat","Sun"].includes(a)}]),key:a},d(a),3)),64)),(f(!0),m(N,null,b(c.value,a=>(f(),m("div",{class:T(["rounded p-1 bg-light-50 flex flex-col gap-1",{"bg-orange-300":i(D)(a,Date.now()),"bg-light-900":i(P)(a),"op-50":i(t).filter(s=>i(D)(i(x)(s.date),a)).length==0&&i(n).filter(s=>i(D)(i(x)(s.date),a)).length==0}]),key:a},[u("div",xe,d(i(p)(a,"dd"))+" "+d(i(v)(a)?i(p)(a,"MMM"):"")+" "+d(i(v)(a)&&i(Q)(a,new Date(a.getFullYear(),0,1))?i(p)(a,"yyyy"):"")+" "+d(i(D)(a,Date.now())?"Today":""),1),i(n)?(f(),m("ul",pe,[(f(!0),m(N,null,b(i(n).filter(s=>i(D)(i(x)(s.date),a)),s=>(f(),m("li",{class:"text-sm rounded",key:s.title},[u("a",{class:T(["flex flex-wrap items-center gap-1 items-start bg-light-500 rounded p-1",{"bg-orange-200":s.id==i(g)}]),href:`/events/#${s.id}`},[u("div",ye,d(i(p)(i(x)(s.date),"HH:mm")),1),o[0]||(o[0]=u("div",{class:"flex-1"},null,-1)),u("div",Ne,d(s==null?void 0:s.type),1),u("div",be,d(s==null?void 0:s.title),1),u("div",Te,d((s==null?void 0:s.price)>0?Number(s.price):"FREE"),1)],10,_e)]))),128))])):w("",!0),i(t)?(f(),m("ul",ke,[(f(!0),m(N,null,b(i(t).filter(s=>i(D)(i(x)(s.date),a)),s=>{var F,S,M,U,I,Y;return f(),m("li",{class:"text-sm rounded",key:s.title},[u("a",{class:T(["flex flex-wrap items-center gap-1 items-start bg-light-500 rounded p-1",{"bg-orange-200":s.id==i(g)}]),href:`/classes/#${s.id}`},[u("div",Ce,d(i(p)(i(x)(s.date),"HH:mm")),1),o[1]||(o[1]=u("div",{class:"flex-1"},null,-1)),u("div",{class:"text-10px uppercase px-1 rounded font-bold brightness-140 saturate-80",style:J({backgroundColor:(S=(F=s==null?void 0:s.course)==null?void 0:F.program)==null?void 0:S.color})},d((U=(M=s==null?void 0:s.course)==null?void 0:M.program)==null?void 0:U.slug)+" "+d((I=s==null?void 0:s.course)==null?void 0:I.level),5),u("div",Fe,d((Y=s==null?void 0:s.module)==null?void 0:Y.title),1)],10,we)])}),128))])):w("",!0)],2))),128))])]))}};export{ze as _};
