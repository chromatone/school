import{l as B,F as G,c as I,G as Y}from"./theme.DUNlFEbY.js";import{u as L}from"./useHash.BmBfzO9y.js";import{t as y,c as H,n as R,s as W,m as $,a as Z,b as q,g as A,d as V,f as p}from"./format.BLmWzEp7.js";import{r as j,e as J,f,h as m,j as o,t as c,u as l,G as N,H as b,I as w,k as z,C as K}from"./framework.DStf2H8E.js";function P(r,e,t){const n=y(r,t==null?void 0:t.in);return isNaN(e)?H(r,NaN):(e&&n.setDate(n.getDate()+e),n)}function Q(r,e){const t=y(r,e==null?void 0:e.in).getDay();return t===0||t===6}function x(r,e,t){const[n,i]=R(t==null?void 0:t.in,r,e);return+W(n)==+W(i)}function O(r,e){return y(r,e==null?void 0:e.in).getDate()===1}function X(r,e,t){const[n,i]=R(t==null?void 0:t.in,r,e);return n.getFullYear()===i.getFullYear()&&n.getMonth()===i.getMonth()}function D(r,e){const t=()=>H(e==null?void 0:e.in,NaN),n=(e==null?void 0:e.additionalDigits)??2,i=ne(r);let d;if(i.date){const a=se(i.date,n);d=ae(a.restDateString,a.year)}if(!d||isNaN(+d))return t();const h=+d;let g=0,u;if(i.time&&(g=le(i.time),isNaN(g)))return t();if(i.timezone){if(u=ie(i.timezone),isNaN(u))return t()}else{const a=new Date(h+g),s=y(0,e==null?void 0:e.in);return s.setFullYear(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()),s.setHours(a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()),s}return y(h+g+u,e==null?void 0:e.in)}const k={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},ee=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,te=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,re=/^([+-])(\d{2})(?::?(\d{2}))?$/;function ne(r){const e={},t=r.split(k.dateTimeDelimiter);let n;if(t.length>2)return e;if(/:/.test(t[0])?n=t[0]:(e.date=t[0],n=t[1],k.timeZoneDelimiter.test(e.date)&&(e.date=r.split(k.timeZoneDelimiter)[0],n=r.substr(e.date.length,r.length))),n){const i=k.timezone.exec(n);i?(e.time=n.replace(i[1],""),e.timezone=i[1]):e.time=n}return e}function se(r,e){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),n=r.match(t);if(!n)return{year:NaN,restDateString:""};const i=n[1]?parseInt(n[1]):null,d=n[2]?parseInt(n[2]):null;return{year:d===null?i:d*100,restDateString:r.slice((n[1]||n[2]).length)}}function ae(r,e){if(e===null)return new Date(NaN);const t=r.match(ee);if(!t)return new Date(NaN);const n=!!t[4],i=_(t[1]),d=_(t[2])-1,h=_(t[3]),g=_(t[4]),u=_(t[5])-1;if(n)return fe(e,g,u)?oe(e,g,u):new Date(NaN);{const a=new Date(0);return!ce(e,d,h)||!de(e,i)?new Date(NaN):(a.setUTCFullYear(e,d,Math.max(i,h)),a)}}function _(r){return r?parseInt(r):1}function le(r){const e=r.match(te);if(!e)return NaN;const t=T(e[1]),n=T(e[2]),i=T(e[3]);return me(t,n,i)?t*$+n*Z+i*1e3:NaN}function T(r){return r&&parseFloat(r.replace(",","."))||0}function ie(r){if(r==="Z")return 0;const e=r.match(re);if(!e)return 0;const t=e[1]==="+"?-1:1,n=parseInt(e[2]),i=e[3]&&parseInt(e[3])||0;return ge(n,i)?t*(n*$+i*Z):NaN}function oe(r,e,t){const n=new Date(0);n.setUTCFullYear(r,0,4);const i=n.getUTCDay()||7,d=(e-1)*7+t+1-i;return n.setUTCDate(n.getUTCDate()+d),n}const ue=[31,null,31,30,31,30,31,31,30,31,30,31];function E(r){return r%400===0||r%4===0&&r%100!==0}function ce(r,e,t){return e>=0&&e<=11&&t>=1&&t<=(ue[e]||(E(r)?29:28))}function de(r,e){return e>=1&&e<=(E(r)?366:365)}function fe(r,e,t){return e>=1&&e<=53&&t>=0&&t<=6}function me(r,e,t){return r===24?e===0&&t===0:t>=0&&t<60&&e>=0&&e<60&&r>=0&&r<25}function ge(r,e){return e>=0&&e<=59}const he={class:"flex flex-col max-w-100vw bg-light-700 shadow-xl my-12 p-2"},xe={class:"flex p-4"},De={class:"text-lg"},pe={class:"grid gap-2 not-prose overflow-x-scroll font-mono overscroll-x-contain",style:{"scrollbar-width":"thin","grid-template-columns":"1fr 1fr 3fr 1fr 3fr 1fr 3fr"}},_e={class:"text-sm font-semibold"},ye={key:0,class:"flex flex-col gap-2"},Ne=["href"],be={class:"text-xs font-bold bg-light-100 bg-op-80 rounded p-1"},we={class:"text-10px uppercase px-1 rounded font-bold brightness-140 saturate-80"},ke={class:"text-sm"},Te={class:"text-sm bg-orange-600 px-1 text-white rounded"},Ce={key:1,class:"flex flex-col gap-2"},Se=["href"],Fe={class:"text-xs font-bold bg-light-100 bg-op-80 rounded p-1"},Me={class:"text-sm",style:{flex:"1 1 220px"}},Ue=7,ve=5,Oe={__name:"ClassSchedule",setup(r){const e=B("https://schooldb.chromatone.center/").with(G()),t=I(async()=>await e.request(Y("classes",{fields:["*","module.title","course.level","course.program.slug","course.program.color"]})),[]),n=I(async()=>await e.request(Y("events",{fields:["*"]})),[]),i=j(q(new Date,{weekStartsOn:0})),d=J(()=>Array.from({length:Ue*ve},(g,u)=>P(i.value,u))),h=L();return(g,u)=>(f(),m("div",he,[o("div",xe,[u[0]||(u[0]=o("div",{class:"text-2xl font-bold"},"Our Schedule",-1)),u[1]||(u[1]=o("div",{class:"flex-1"},null,-1)),o("div",De,"Week "+c(l(A)(Date.now()))+" "+c(l(V)(Date.now())),1)]),o("div",pe,[(f(),m(N,null,b(["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],a=>o("div",{class:w(["rounded font-bold bg-gray-400 p-2 sticky top-0 z-100",{"bg-orange-300":["Sat","Sun"].includes(a)}]),key:a},c(a),3)),64)),(f(!0),m(N,null,b(d.value,a=>(f(),m("div",{class:w(["rounded p-1 bg-light-50 flex flex-col gap-1",{"bg-orange-300":l(x)(a,Date.now()),"bg-light-900":l(Q)(a),"op-50":l(t).filter(s=>l(x)(l(D)(s.date),a)).length==0&&l(n).filter(s=>l(x)(l(D)(s.date),a)).length==0}]),key:a},[o("div",_e,c(l(p)(a,"dd"))+" "+c(l(O)(a)?l(p)(a,"MMM"):"")+" "+c(l(O)(a)&&l(X)(a,new Date(a.getFullYear(),0,1))?l(p)(a,"yyyy"):"")+" "+c(l(x)(a,Date.now())?"Today":""),1),l(n)?(f(),m("ul",ye,[(f(!0),m(N,null,b(l(n).filter(s=>l(x)(l(D)(s.date),a)),s=>(f(),m("li",{class:"text-sm rounded",key:s.title},[o("a",{class:w(["flex flex-wrap items-center gap-1 items-start bg-light-500 rounded p-1",{"bg-orange-200":s.id==l(h)}]),href:`/events/#${s.id}`},[o("div",be,c(l(p)(l(D)(s.date),"HH:mm")),1),u[2]||(u[2]=o("div",{class:"flex-1"},null,-1)),o("div",we,c(s==null?void 0:s.type),1),o("div",ke,c(s==null?void 0:s.title),1),o("div",Te,c((s==null?void 0:s.price)>0?Number(s.price):"FREE"),1)],10,Ne)]))),128))])):z("",!0),l(t)?(f(),m("ul",Ce,[(f(!0),m(N,null,b(l(t).filter(s=>l(x)(l(D)(s.date),a)),s=>{var C,S,F,M,U,v;return f(),m("li",{class:"text-sm rounded",key:s.title},[o("a",{class:w(["flex flex-wrap items-center gap-1 items-start bg-light-500 rounded p-1",{"bg-orange-200":s.id==l(h)}]),href:`/classes/#${s.id}`},[o("div",Fe,c(l(p)(l(D)(s.date),"HH:mm")),1),u[3]||(u[3]=o("div",{class:"flex-1"},null,-1)),o("div",{class:"text-10px uppercase px-1 rounded font-bold brightness-140 saturate-80",style:K({backgroundColor:(S=(C=s==null?void 0:s.course)==null?void 0:C.program)==null?void 0:S.color})},c((M=(F=s==null?void 0:s.course)==null?void 0:F.program)==null?void 0:M.slug)+" "+c((U=s==null?void 0:s.course)==null?void 0:U.level),5),o("div",Me,c((v=s==null?void 0:s.module)==null?void 0:v.title),1)],10,Se)])}),128))])):z("",!0)],2))),128))])]))}};export{Oe as _};
