import{l as E,F as B,c as F,G as M}from"./theme.DwfYwzmn.js";import{u as G}from"./useHash.mPwdT7Su.js";import{t as T,c as H,n as L,s as O,m as R,a as $,b as q,g as A,d as V,f as _}from"./format.BLmWzEp7.js";import{r as j,e as J,f as g,h,j as u,t as c,u as l,G as N,H as b,I as w,k as Y,C as K}from"./framework.BrhOyqmp.js";function P(r,e,t){const s=T(r,t==null?void 0:t.in);return isNaN(e)?H(r,NaN):(e&&s.setDate(s.getDate()+e),s)}function Q(r,e){const t=T(r,e==null?void 0:e.in).getDay();return t===0||t===6}function p(r,e,t){const[s,i]=L(t==null?void 0:t.in,r,e);return+O(s)==+O(i)}function D(r,e){const t=()=>H(e==null?void 0:e.in,NaN),s=(e==null?void 0:e.additionalDigits)??2,i=re(r);let d;if(i.date){const a=se(i.date,s);d=ne(a.restDateString,a.year)}if(!d||isNaN(+d))return t();const x=+d;let f=0,m;if(i.time&&(f=ae(i.time),isNaN(f)))return t();if(i.timezone){if(m=ie(i.timezone),isNaN(m))return t()}else{const a=new Date(x+f),o=T(0,e==null?void 0:e.in);return o.setFullYear(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()),o.setHours(a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()),o}return T(x+f+m,e==null?void 0:e.in)}const k={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},X=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,ee=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,te=/^([+-])(\d{2})(?::?(\d{2}))?$/;function re(r){const e={},t=r.split(k.dateTimeDelimiter);let s;if(t.length>2)return e;if(/:/.test(t[0])?s=t[0]:(e.date=t[0],s=t[1],k.timeZoneDelimiter.test(e.date)&&(e.date=r.split(k.timeZoneDelimiter)[0],s=r.substr(e.date.length,r.length))),s){const i=k.timezone.exec(s);i?(e.time=s.replace(i[1],""),e.timezone=i[1]):e.time=s}return e}function se(r,e){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),s=r.match(t);if(!s)return{year:NaN,restDateString:""};const i=s[1]?parseInt(s[1]):null,d=s[2]?parseInt(s[2]):null;return{year:d===null?i:d*100,restDateString:r.slice((s[1]||s[2]).length)}}function ne(r,e){if(e===null)return new Date(NaN);const t=r.match(X);if(!t)return new Date(NaN);const s=!!t[4],i=y(t[1]),d=y(t[2])-1,x=y(t[3]),f=y(t[4]),m=y(t[5])-1;if(s)return de(e,f,m)?le(e,f,m):new Date(NaN);{const a=new Date(0);return!ue(e,d,x)||!ce(e,i)?new Date(NaN):(a.setUTCFullYear(e,d,Math.max(i,x)),a)}}function y(r){return r?parseInt(r):1}function ae(r){const e=r.match(ee);if(!e)return NaN;const t=v(e[1]),s=v(e[2]),i=v(e[3]);return fe(t,s,i)?t*R+s*$+i*1e3:NaN}function v(r){return r&&parseFloat(r.replace(",","."))||0}function ie(r){if(r==="Z")return 0;const e=r.match(te);if(!e)return 0;const t=e[1]==="+"?-1:1,s=parseInt(e[2]),i=e[3]&&parseInt(e[3])||0;return me(s,i)?t*(s*R+i*$):NaN}function le(r,e,t){const s=new Date(0);s.setUTCFullYear(r,0,4);const i=s.getUTCDay()||7,d=(e-1)*7+t+1-i;return s.setUTCDate(s.getUTCDate()+d),s}const oe=[31,null,31,30,31,30,31,31,30,31,30,31];function Z(r){return r%400===0||r%4===0&&r%100!==0}function ue(r,e,t){return e>=0&&e<=11&&t>=1&&t<=(oe[e]||(Z(r)?29:28))}function ce(r,e){return e>=1&&e<=(Z(r)?366:365)}function de(r,e,t){return e>=1&&e<=53&&t>=0&&t<=6}function fe(r,e,t){return r===24?e===0&&t===0:t>=0&&t<60&&e>=0&&e<60&&r>=0&&r<25}function me(r,e){return e>=0&&e<=59}const ge={class:"flex flex-col max-w-100vw bg-light-700 shadow-xl my-12 p-2"},he={class:"flex p-4"},xe={class:"text-lg"},pe={class:"grid gap-2 not-prose overflow-x-scroll font-mono overscroll-x-contain",style:{"scrollbar-width":"thin","grid-template-columns":"1fr 1fr 3fr 1fr 3fr 1fr 3fr"}},De={class:"text-sm font-thin"},_e={key:0,class:"flex flex-col gap-2"},ye=["href"],Ne={class:"text-xs font-bold bg-light-100 bg-op-80 rounded p-1"},be={class:"text-10px uppercase px-1 rounded font-bold brightness-140 saturate-80"},we={class:"text-sm"},ke={class:"text-sm bg-orange-600 px-1 text-white rounded"},Te={key:1,class:"flex flex-col gap-2"},ve=["href"],Ce={class:"text-xs font-bold bg-light-100 bg-op-80 rounded p-1"},Se={class:"text-sm",style:{flex:"1 1 220px"}},Ue=7,Ie=5,Oe={__name:"ClassSchedule",setup(r){const e=E("https://schooldb.chromatone.center/").with(B()),t=F(async()=>await e.request(M("classes",{fields:["*","module.title","course.level","course.program.slug","course.program.color"]})),[]),s=F(async()=>await e.request(M("events",{fields:["*"]})),[]),i=j(q(new Date,{weekStartsOn:0})),d=J(()=>Array.from({length:Ue*Ie},(m,a)=>P(i.value,a))),x=G();function f(m){return t.value&&t.value.filter(a=>p(D(a.date),m)).length>0||s.value&&s.value.filter(a=>p(D(a.date),m)).length>0}return(m,a)=>(g(),h("div",ge,[u("div",he,[a[0]||(a[0]=u("div",{class:"text-2xl font-bold"},"Our Schedule",-1)),a[1]||(a[1]=u("div",{class:"flex-1"},null,-1)),u("div",xe,"Week "+c(l(A)(Date.now()))+" "+c(l(V)(Date.now())),1)]),u("div",pe,[(g(),h(N,null,b(["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],o=>u("div",{class:w(["rounded font-bold bg-gray-400 p-2 sticky top-0 z-100",{"bg-orange-300":["Sat","Sun"].includes(o)}]),key:o},c(o),3)),64)),(g(!0),h(N,null,b(d.value,o=>(g(),h("div",{class:w(["rounded p-1 bg-light-50 flex flex-col gap-1",{"bg-orange-300":l(p)(o,Date.now()),"bg-light-900":l(Q)(o),"op-50":!f(o)}]),key:o},[u("div",De,c(l(_)(o,"dd"))+" "+c(f(o)?l(_)(o,"MMM"):"")+" "+c(f(o)?l(_)(o,"yyyy"):"")+" "+c(l(p)(o,Date.now())?"Today":""),1),l(s)?(g(),h("ul",_e,[(g(!0),h(N,null,b(l(s).filter(n=>l(p)(l(D)(n.date),o)),n=>(g(),h("li",{class:"text-sm rounded",key:n.title},[u("a",{class:w(["flex flex-wrap items-center gap-1 items-start bg-light-500 rounded p-1",{"bg-orange-200":n.id==l(x)}]),href:`/events/#${n.id}`},[u("div",Ne,c(l(_)(l(D)(n.date),"HH:mm")),1),a[2]||(a[2]=u("div",{class:"flex-1"},null,-1)),u("div",be,c(n==null?void 0:n.type),1),u("div",we,c(n==null?void 0:n.title),1),u("div",ke,c((n==null?void 0:n.price)>0?Number(n.price):"FREE"),1)],10,ye)]))),128))])):Y("",!0),l(t)?(g(),h("ul",Te,[(g(!0),h(N,null,b(l(t).filter(n=>l(p)(l(D)(n.date),o)),n=>{var C,S,U,I,W,z;return g(),h("li",{class:"text-sm rounded",key:n.title},[u("a",{class:w(["flex flex-wrap items-center gap-1 items-start bg-light-500 rounded p-1",{"bg-orange-200":n.id==l(x)}]),href:`/classes/#${n.id}`},[u("div",Ce,c(l(_)(l(D)(n.date),"HH:mm")),1),a[3]||(a[3]=u("div",{class:"flex-1"},null,-1)),u("div",{class:"text-10px uppercase px-1 rounded font-bold brightness-140 saturate-80",style:K({backgroundColor:(S=(C=n==null?void 0:n.course)==null?void 0:C.program)==null?void 0:S.color})},c((I=(U=n==null?void 0:n.course)==null?void 0:U.program)==null?void 0:I.slug)+" "+c((W=n==null?void 0:n.course)==null?void 0:W.level),5),u("div",Se,c((z=n==null?void 0:n.module)==null?void 0:z.title),1)],10,ve)])}),128))])):Y("",!0)],2))),128))])]))}};export{Oe as _};
